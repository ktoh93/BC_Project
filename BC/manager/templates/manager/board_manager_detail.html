{% extends 'manager/manager_base.html' %}
{% load static %}

{% block title %}ê´€ë¦¬ì - {{ article.title }} ìƒì„¸ë³´ê¸°{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'manager/css/manager_detail.css' %}">
{% endblock %}

{% block content %}

<div class="article-box">
    <h1 class="box-header">ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸°</h1>

    <div class="detail-wrapper">
        <h2 class="detail-title">{{ article.title }}</h2>

        <div class="detail-meta">
            <span>ì‘ì„±ì: {{ author }}</span>
            <span>ì‘ì„±ì¼: {{ article.reg_date|date:"Y-m-d" }}</span>
            <span>ì¡°íšŒìˆ˜: {{ article.view_cnt }}</span>
        </div>

        <div class="detail-content">
            {{ article.contents|linebreaksbr }}
        </div>

        {% if files %}
        <div class="detail-files">
            <h3>ì²¨ë¶€íŒŒì¼</h3>
            <ul>
                {% for file in files %}
                <li><a href="{{ file.url }}" download>{{ file.name }}</a></li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        {% if images %}
        <div class="detail-images-section">
            <h3 class="detail-section-title">ì´ë¯¸ì§€ ì²¨ë¶€</h3>
            <div class="detail-image-grid">
                {% for image in images %}
                <div class="detail-image-box">
                    <img src="{{ image.url }}" class="detail-image">
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
        <section class="comment-section">
            <h3 class="section-title">ëŒ“ê¸€ ({{ comments|length }})</h3>

            <ul class="comment-list">
                {% for comment in comments %}
                 <li class="comment-item {% if comment.is_deleted %}comment-deleted{% endif %}">
                    <div class="comment-meta">
                        <span class="comment-writer {% if comment.is_admin %}admin-badge{% elif comment.is_author %}author-badge{% endif %}">
                            {{ comment.author }}{% if comment.is_admin %} ğŸ‘‘{% elif comment.is_author %} (ì‘ì„±ì) {% endif %}
                        </span>
                        <span class="comment-date">
                            {{ comment.reg_date|date:"Y-m-d H:i" }}
                        </span>

                        {% if not comment.is_deleted %}
                        <button type="button"
                                class="comment-delete-btn"
                                data-comment-id="{{ comment.comment_id }}">
                            ì‚­ì œ
                        </button>
                        {% endif %}
                    </div>

                    <p class="comment-content">{{ comment.comment|linebreaksbr }}</p>
                </li>
                {% empty %}
                <li class="comment-empty">ì•„ì§ ë“±ë¡ëœ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</li>
                {% endfor %}
            </ul>

        </section>


        <div class="detail-actions">
            <a href="{% url 'manager:board_edit' article.board_id_id article.article_id %}" class="btn btn-edit">ìˆ˜ì •</a>
            <a href="{% url 'manager:board_list' article.board_id_id %}" class="btn btn-list">ëª©ë¡</a>
        </div>
    </div>
</div>

{% endblock %}
{% block extra_js %}
<script src="{% static 'manager/js/comment_delete.js' %}"></script>
{% endblock %}
