{% extends 'common/base.html' %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'board/css/board_list.css' %}" />
<link rel="stylesheet" href="{% static 'board/css/post_write.css' %}" />
{% endblock %}

{% block script1 %}
<script src="{% static 'board/js/post_write.js' %}"></script>
{% endblock %}

{% block title %}
{{ b_name }}ê²Œì‹œê¸€ ì‘ì„± - í• ë˜ë§ë˜
{% endblock %}

{% block contents %}

<!-- Hero ì„¹ì…˜ -->
<div class="board-hero post-hero">
    <h2>ê²Œì‹œê¸€ ì‘ì„±</h2>
</div>

<!-- ì„œë¸Œ ì»¨í…Œì´ë„ˆ -->
<div class="sub-container">
    <div class="sub-content">
        <div class="form-wrapper">
            <form method="post" action=" {% if is_edit %}
            {% url 'board:update' board_name article.article_id %}
        {% else %}
            {% url 'board:write' board_name %}
        {% endif %}" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- ì œëª© -->
                <div class="form-group full-row">
                    <label class="form-label">ì œëª©</label>
                    <input type="text" name="title" class="form-input" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                        value="{% if is_edit %}{{ article.title }}{% endif %}" required>
                </div>

                <!-- ë‚´ìš© -->
                <div class="form-group full-row">
                    <label class="form-label">ë‚´ìš©</label>
                    <textarea name="context" class="form-textarea" rows="15" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"
                        required>{% if is_edit %}{{ article.contents }}{% endif %}</textarea>
                </div>

                <!-- íŒŒì¼ ì²¨ë¶€ -->
                <div class="form-group full-row">
                    <label class="form-label">ì²¨ë¶€íŒŒì¼</label>

                    <div class="file-upload-wrapper">
                        <input type="file" name="file" id="fileInput" class="file-input" multiple>
                        <label for="fileInput" class="file-upload-btn">
                            <span>ğŸ“ íŒŒì¼ ì„ íƒ</span>
                        </label>
                        <div class="file-list" id="fileList"></div>
                    </div>

                    {% if is_edit and existing_files %}
                    <div class="existing-files" style="margin-top: 10px;">
                        <label class="form-label" style="font-size: 14px;">ê¸°ì¡´ ì²¨ë¶€íŒŒì¼:</label>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 5px;">
                            {% for file in existing_files %}
                            <div class="exist-file-item"
                                style="padding: 5px 10px; background: #f5f5f5; border-radius: 4px; font-size: 13px; display:flex; align-items:center; gap:8px;">

                                <a href="{{ file.url }}" target="_blank" style="text-decoration:none; color:#2f5c9c;">
                                    {{ file.name }}
                                </a>

                                <button type="button" class="delete-existing-btn" data-file-id="{{ file.id }}"
                                    style="background:#ff4d4d; color:white; border:none; padding:2px 6px; cursor:pointer; border-radius:3px;">
                                    X
                                </button>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>

                <!-- ë²„íŠ¼ -->
                <div class="btn-row">
                    <div class="btn-left">
                        <span class='article-list'>
                            <a href="{% url 'board:list' board_name %}" class="btn btn-list">ëª©ë¡ìœ¼ë¡œ</a>
                        </span>
                    </div>

                    <div class="btn-right">
                        <button type="submit" class="btn btn-submit">ì‘ì„±</button>
                        {% if article.article_id %}
                        <a href="{% url 'board:detail' board_name article.article_id %}" class="btn btn-list">ì·¨ì†Œ</a>
                        {% endif %}
                    </div>
                </div>

            </form>
        </div>
    </div>
</div>

{% endblock %}